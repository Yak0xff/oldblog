{"title":"ä»Keraså¼€å§‹æ„å»ºiOSå¹³å°æ‰‹å†™æ•°å­—å®æ—¶è¯†åˆ«","uid":"4e4a7be388e7ca1f326d22f43bf851ec","slug":"2019-01-22-keras_mnist_for_iOS","date":"2023-05-13T14:55:49.791Z","updated":"2023-05-13T14:55:49.795Z","comments":true,"path":"api/articles/2019-01-22-keras_mnist_for_iOS.json","keywords":null,"cover":"/images/keras-mnist-for-ios/cover.jpg","content":"<p>æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•æ„å»ºå’Œè®­ç»ƒä¸€ä¸ªæ·±åº¦å­¦ä¹ ç½‘ç»œæ¥è¯†åˆ«æ‰‹å†™æ•°å­—ï¼Œä»¥åŠå¦‚ä½•å°†è®­ç»ƒæ‰€å¾—çš„æ·±åº¦ç½‘ç»œæ¨¡å‹è½¬æ¢ä¸ºiOSå¹³å°çš„æœºå™¨å­¦ä¹ æ¡†æ¶CoreMLæ ¼å¼ï¼Œå¹¶é›†æˆè¿›iOSåº”ç”¨ç¨‹åºä¸­ä»¥å®æ—¶è¯†åˆ«æ•°å­—ç­‰ã€‚</p>\n<h1 id=\"10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨\"><a href=\"#10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨\" class=\"headerlink\" title=\"10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨\"></a><strong>10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨</strong></h1><p><strong>TLDRï¼›</strong></p>\n<p>æœ¬æ–‡ä¸­æš‚æ—¶ä¸ä¼šä»‹ç»å·ç§¯ç¥ç»ç½‘ç»œçš„ç»†èŠ‚å†…å®¹ï¼Œä¾‹å¦‚å¦‚ä½•ä½¿ç”¨å·ç§¯å±‚ã€æ± åŒ–å±‚è®­ç»ƒæ·±åº¦å­¦ä¹ ç½‘ç»œï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹è¯†åˆ«ç›®æ ‡ç­‰ï¼Œç›¸å…³å·ç§¯ç¥ç»ç½‘ç»œç»†èŠ‚çš„å†…å®¹å°†ä¼šæ”¾åœ¨æœ¬æ–‡å†…å®¹ä¹‹åï¼Œè¿›è¡Œè¯¦ç»†çš„ä»‹ç»ã€‚æœ¬æ–‡æ—¨åœ¨ä»‹ç»å¦‚ä½•ä¸€æ­¥ä¸€æ­¥çš„ä»æ•°æ®çš„è·å–ã€æ•´ç†ã€æ¨¡å‹çš„æ„å»ºã€è®­ç»ƒä»¥åŠåé¢çš„æ ¼å¼è½¬æ¢ã€ä½¿ç”¨ç­‰ä»‹ç»Kerasæ¡†æ¶çš„åŸºæœ¬ä½¿ç”¨å’Œå¦‚ä½•ä½¿ç”¨CoreMLä½“ç³»åœ¨ä¸€ä¸ªå®å®åœ¨åœ¨çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨æ¨¡å‹ç­‰ã€‚</p>\n<p>ä¸‹å›¾æ˜¯æœ€ç»ˆç»“æœçš„é¢„è§ˆï¼š</p>\n<p><img src=\"https://liip.rokka.io/www_inarticle/812493/output.gif\"></p>\n<p>æ¥ä¸‹æ¥ï¼Œå¼€å§‹ä¸€æ­¥æ­¥çš„å®ç°ç›¸å…³çš„è¿‡ç¨‹ç­‰ã€‚</p>\n<h2 id=\"1-å¦‚ä½•å¼€å§‹\"><a href=\"#1-å¦‚ä½•å¼€å§‹\" class=\"headerlink\" title=\"1. å¦‚ä½•å¼€å§‹\"></a>1. <strong>å¦‚ä½•å¼€å§‹</strong></h2><p>To have a fully working example I thought weâ€™d start with a toy dataset like theÂ <a href=\"https://en.wikipedia.org/wiki/MNIST_database\">MNIST set of handwritten letters</a>Â and train a deep learning network to recognize those. Once itâ€™s working nicely on our PC, we will port it to an iPhone X using theÂ <a href=\"https://developer.apple.com/documentation/coreml\">CoreML standard</a>.</p>\n<p>åœ¨è®¡ç®—æœºç¨‹åºè®¾è®¡å­¦ä¹ çš„è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹éƒ½æ˜¯ä»¥ä¸€ä¸ªç»å…¸çš„â€œHello Worldâ€ç¨‹åºå¼€å§‹çš„ã€‚è€Œåœ¨æœºå™¨å­¦ä¹ é¢†åŸŸï¼ŒåŒæ ·å…·æœ‰ç±»ä¼¼â€œHello Worldâ€çš„ä¸€ä¸ªç»å…¸å…¥é—¨çº§æ•°æ®é›†â€”â€”<a href=\"https://en.wikipedia.org/wiki/MNIST_database\">MNIST</a>ï¼Œè¯¥æ•°æ®é›†æ˜¯ä¸€ç³»åˆ—æ‰‹å†™æ•°å­—0åˆ°9çš„å›¾ç‰‡æ–‡ä»¶ï¼Œè¿™é‡Œçš„ç›®çš„æ˜¯ä½¿ç”¨è¿™ä¸ªæ•°æ®é›†è®­ç»ƒä¸€ä¸ªæ·±åº¦å­¦ä¹ ç½‘ç»œæ¥è¯†åˆ«å®ƒä»¬ã€‚åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ æˆ–è®¸å¯¹iOSå¹³å°çš„CoreMLä»¥åŠkerasè¿˜å¾ˆé™Œç”Ÿï¼Œä½ å¯ä»¥å…ˆäº†è§£ä¸€ä¸‹å®ƒä»¬çš„ä½“ç³»å’Œè®¾è®¡ï¼š</p>\n<ul>\n<li>CoreMLï¼š</li>\n</ul>\n<p><a href=\"https://developer.apple.com/documentation/coreml\">Core ML | Apple Developer Documentation</a></p>\n<ul>\n<li>Kerasï¼š</li>\n</ul>\n<p><a href=\"https://keras.io/zh/\">Keras ä¸­æ–‡æ–‡æ¡£</a></p>\n<h2 id=\"2-è·å–æ•°æ®\"><a href=\"#2-è·å–æ•°æ®\" class=\"headerlink\" title=\"2. è·å–æ•°æ®\"></a>2. è·å–æ•°æ®</h2><p>åœ¨å¤§å¤šæ•°çš„Pythonæœºå™¨å­¦ä¹ ç±»åº“ä¸­ï¼Œéƒ½æœ‰å†…ç½®çš„æ•°æ®é›†è®¿é—®æ¥å£ï¼Œä»¥æ–¹ä¾¿ä½¿ç”¨è€…çš„ä½¿ç”¨ï¼Œåœ¨Kerasä¸­ä¹Ÿä¸ä¾‹å¤–ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨å…¶å†…ç½®çš„æ•°æ®é›†è®¿é—®æ¥å£è·å–æ•°æ®é›†ï¼Œå…·ä½“çš„æ¥å£å®šä¹‰åœ¨<code>keras.datasets</code>ä¸­ï¼Œå…·ä½“çš„ä½¿ç”¨å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># ä½¿ç”¨Keraså†…ç½®æ•°æ®é›†è®¿é—®æ¥å£å¯¼å…¥æ•°æ®é›†å¹¶å¯¹æ•°æ®é›†è¿›è¡Œè½¬æ¢\n    from keras.datasets import mnist\n    from keras.utils import np_utils\n    from keras import backend as K\n    \n    def mnist_data():\n        # å®šä¹‰è¾“å…¥å›¾åƒçš„ç»´åº¦\n        img_rows, img_cols &#x3D; 28, 28\n        # åŠ è½½æ•°æ®é›†\n        (X_train, Y_train), (X_test, Y_test) &#x3D; mnist.load_data()\n    \n        if K.image_data_format() &#x3D;&#x3D; &#39;channels_first&#39;:\n            X_train &#x3D; X_train.reshape(X_train.shape[0], 1, img_rows, img_cols)\n            X_test &#x3D; X_test.reshape(X_test.shape[0], 1, img_rows, img_cols)\n            input_shape &#x3D; (1, img_rows, img_cols)\n        else:\n            X_train &#x3D; X_train.reshape(X_train.shape[0], img_rows, img_cols, 1)\n            X_test &#x3D; X_test.reshape(X_test.shape[0], img_rows, img_cols, 1)\n            input_shape &#x3D; (img_rows, img_cols, 1)\n    \n        # æ•°æ®ç¼©æ”¾ï¼Œå°†åŸæ¥çš„ [0, 255] ç¼©æ”¾è‡³ [0, 1]\n        X_train &#x3D; X_train.astype(&#39;float32&#39;)&#x2F;255\n        X_test &#x3D; X_test.astype(&#39;float32&#39;)&#x2F;255\n    \n        # å¯¹åŸå§‹æ•°æ®ä¸­çš„ç›®æ ‡å€¼è¿›è¡ŒOne-Hot Encodingï¼Œä½¿å¾—ç›®æ ‡æ•°æ®æ›´åŠ çš„ç¨€ç–\n        Y_train &#x3D; np_utils.to_categorical(Y_train, 10)\n        Y_test &#x3D; np_utils.to_categorical(Y_test, 10)\n    \n        # è¿”å›ç»“æœ\n        return (X_train, Y_train), (X_test, Y_test), input_shape\n    \n    (X_train, Y_train), (X_test, Y_test), input_shape &#x3D; mnist_data()</code></pre>\n\n<h2 id=\"3-æ­£ç¡®åœ°ç¼–ç \"><a href=\"#3-æ­£ç¡®åœ°ç¼–ç \" class=\"headerlink\" title=\"3. æ­£ç¡®åœ°ç¼–ç \"></a>3. æ­£ç¡®åœ°ç¼–ç </h2><p>å½“å¤„ç†å›¾ç‰‡æ•°æ®çš„æ—¶å€™ï¼Œå¿…é¡»è¦åŒºåˆ†æƒ³è¦çš„ç¼–ç æ–¹å¼ã€‚Kerasæ˜¯ä¸€ä¸ªå¯ä»¥å¤„ç†å¤šä¸ªâ€œåç«¯â€çš„é«˜çº§åº“ï¼Œä¾‹å¦‚<a href=\"https://www.tensorflow.org/\">Tensorflow</a>,Â <a href=\"http://deeplearning.net/software/theano/\">Theano</a>Â å’ŒÂ <a href=\"https://www.microsoft.com/en-us/cognitive-toolkit/\">CNTK</a>ï¼Œé¦–å…ˆæˆ‘ä»¬è¦äº†è§£æˆ‘ä»¬æ‰€ä½¿ç”¨çš„åç«¯æ˜¯å¦‚ä½•ç¼–ç æ•°æ®çš„ã€‚åœ¨Kerasé»˜è®¤ä½¿ç”¨çš„TensorFlowåç«¯ä¸­ï¼Œé’ˆå¯¹å›¾åƒçš„å¤„ç†é€šå¸¸æ˜¯ä»¥â€œé€šé“ä¼˜å…ˆâ€æˆ–â€œé€šé“æœ«å°¾â€çš„æ–¹å¼è¿›è¡Œç¼–ç çš„ï¼Œå› æ­¤åœ¨æˆ‘ä»¬çš„ä½¿ç”¨TensorFlowä½œä¸ºåç«¯çš„æ—¶å€™ï¼Œç¼–ç ç»“æœå…¶å®æ˜¯ä¸€ä¸ªå¼ é‡ï¼Œå…¶å½¢çŠ¶ä¸º(batch_size, rows, cols, channels)ã€‚æ„å‘³ç€é¦–å…ˆæ˜¯è¾“å…¥çš„batch_sizeï¼Œç„¶åè¾“å…¥28è¡Œ28åˆ—çš„å›¾åƒç»´åº¦ï¼Œæœ€åè¾“å…¥1ä½œä¸ºé€šé“æ•°ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ç°åº¦å›¾åƒæ•°æ®ã€‚</p>\n<p>æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å‰6å¼ å›¾åƒå…·ä½“æ˜¯ä»€ä¹ˆæ ·å­ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹ä»£ç æŸ¥çœ‹ï¼š</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># å¯è§†åŒ–æ•°æ®é›†ä¸­å‰6å¼ å›¾åƒ\n    import matplotlib.pyplot as plt\n    %matplotlib inline\n    import matplotlib.cm as cm\n    import numpy as np\n    \n    (X_train, y_train), (X_test, y_test) &#x3D; mnist.load_data()\n    \n    fig &#x3D; plt.figure(figsize&#x3D;(20,20))\n    for i in range(6):\n        ax &#x3D; fig.add_subplot(1, 6, i+1, xticks&#x3D;[], yticks&#x3D;[])\n        ax.imshow(X_train[i], cmap&#x3D;&#39;gray&#39;)\n        ax.set_title(str(y_train[i]))\n    plt.show()</code></pre>\n\n<p><img src=\"https://liip.rokka.io/www_inarticle/7cce04/numbers.png\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"4-è§„èŒƒåŒ–æ•°æ®\"><a href=\"#4-è§„èŒƒåŒ–æ•°æ®\" class=\"headerlink\" title=\"4. è§„èŒƒåŒ–æ•°æ®\"></a>4. è§„èŒƒåŒ–æ•°æ®</h2><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨é»‘è‰²èƒŒæ™¯ä¸­æ˜¾ç¤ºäº†ç™½è‰²æ•°å­—ï¼Œæ¯ä¸€å¼ å›¾åƒä¸­çš„æ•°å­—éƒ½æ˜¯å±…ä¸­çš„ï¼Œè€Œä¸”åˆ†è¾¨ç‡éƒ½å¾ˆä½â€”â€”åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯28x28åƒç´ ã€‚</p>\n<p>ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåœ¨ä¸Šè¿°è·å–æ•°æ®çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯¹æ¯ä¸€å¼ å›¾ç‰‡é™¤ä»¥255æ¥ç¼©æ”¾äº†å›¾åƒåƒç´ ï¼Œè¿™å¯¼è‡´åƒç´ å€¼åœ¨0å’Œ1ä¹‹é—´ï¼Œè¿™å¯¹äºä»»ä½•ç±»å‹çš„è®­ç»ƒéƒ½éå¸¸æœ‰ç”¨ã€‚æ¯ä¸ªå›¾åƒåƒç´ å€¼åœ¨è½¬æ¢ä¹‹å‰éƒ½æ˜¯è¿™æ ·çš„ï¼š</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># ä½¿ç”¨åƒç´ å€¼å¯è§†åŒ–ä¸€ä¸ªæ•°å­—\ndef visualize_input(img, ax):\n    ax.imshow(img, cmap&#x3D;&#39;gray&#39;)\n    width, height &#x3D; img.shape\n    thresh &#x3D; img.max()&#x2F;2.5\n    for x in range(width):\n        for y in range(height):\n            ax.annotate(str(round(img[x][y], 2)),\n                        xy&#x3D;(y, x),\n                        horizontalalignment&#x3D;&#39;center&#39;,\n                        verticalalignment&#x3D;&#39;center&#39;,\n                        color&#x3D;&#39;white&#39; if img[x][y] &lt; thresh else &#39;black&#39;)\n\nfig &#x3D; plt.figure(figsize&#x3D;(12, 12))\nax &#x3D; fig.add_subplot(111)\nvisualize_input(X_train[0], ax)\nplt.show()</code></pre>\n\n<p><img src=\"/images/keras-mnist-for-ios/pixes-daf69647-717f-499d-aa39-fa83904d7675.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°å›¾åƒä¸­çš„æ¯ä¸ªç°åº¦åƒç´ éƒ½æ˜¯ä»‹äº0åˆ°255ä¹‹é—´çš„ï¼Œå¹¶ä¸”å½“åƒç´ ä¸º255æ—¶ï¼ŒèƒŒæ™¯è‰²ä¸ºç™½è‰²ï¼Œåƒç´ ä¸º0æ—¶ï¼ŒèƒŒæ™¯è‰²ä¸ºé»‘è‰²ã€‚åœ¨è¿™é‡Œä½¿ç”¨çš„æ˜¯<code>mnist.load_data()</code>åŠ è½½çš„æ•°æ®é›†ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰å¯¹å›¾åƒè¿›è¡Œåƒç´ ç¼©æ”¾ï¼Œè€Œåœ¨æˆ‘ä»¬è‡ªå®šä¹‰çš„æ•°æ®é›†åŠ è½½æ–¹æ³•<code>mnist_data()</code>æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬è¿›è¡Œäº†åƒç´ çš„ç¼©æ”¾ï¼Œ<code>X_train = X_train.astype(&#39;float32&#39;)/255</code>Â ã€‚</p>\n<h2 id=\"5-One-Hot-ç¼–ç \"><a href=\"#5-One-Hot-ç¼–ç \" class=\"headerlink\" title=\"5. One-Hot ç¼–ç \"></a>5. One-Hot ç¼–ç </h2><p>æœ€åˆï¼Œæ•°æ®ä»¥Y-VectoråŒ…å«X Vectorï¼ˆåƒç´ æ•°æ®ï¼‰åŒ…å«çš„æ•°å€¼çš„æ–¹å¼ç¼–ç ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå›¾åƒçœ‹èµ·æ¥åƒ7ï¼Œé‚£ä¹ˆY-Vectorä¸­å¿…å®šåŒ…å«æ•°å­—7ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¸åˆ©äºæˆ‘ä»¬åœ¨ç½‘ç»œç»“æ„ä¸­ç›´æ¥ä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œè¿™ç§è½¬æ¢ï¼Œå¸Œæœ›å°†æ•°æ®çš„è¾“å‡ºæ˜ å°„åˆ°ç½‘ç»œä¸­çš„10ä¸ªè¾“å‡ºç¥ç»å…ƒï¼Œæ­¤æ—¶å½“ç›¸åº”çš„æ•°å­—è¢«è¯†åˆ«æ—¶ï¼Œç›¸åº”çš„ç¥ç»å…ƒå°±ä¼šè§¦å‘ï¼Œä»è€Œè¾¾åˆ°æœ‰æ•ˆçš„è¯†åˆ«ã€‚</p>\n<p><img src=\"https://liip.rokka.io/www_inarticle/46a2ef/onehot.png\"></p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"6-ç½‘ç»œæ¨¡å‹åŒ–\"><a href=\"#6-ç½‘ç»œæ¨¡å‹åŒ–\" class=\"headerlink\" title=\"6. ç½‘ç»œæ¨¡å‹åŒ–\"></a>6. ç½‘ç»œæ¨¡å‹åŒ–</h2><p>äº†è§£äº†æ•°æ®é›†çš„åŸºæœ¬æƒ…å†µä»¥åŠè¿›è¡Œåˆç†çš„æ•°æ®è½¬æ¢åï¼Œè¯¥æ˜¯å®šä¹‰å·ç§¯ç¥ç»ç½‘ç»œçš„æ—¶å€™äº†ã€‚è¿™é‡Œè®²ç›´æ¥ä½¿ç”¨å·ç§¯ç¥ç»ç½‘ç»œä¸­çš„å·ç§¯å±‚å’Œæ± åŒ–å±‚æ¥å®šä¹‰ç½‘ç»œï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># å®šä¹‰ç½‘ç»œæ¨¡å‹\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras.optimizers import Adadelta\n\ndef network():\n    model &#x3D; Sequential()\n    input_shape &#x3D; (28, 28, 1)\n    num_classes &#x3D; 10\n\n    model.add(Conv2D(filters&#x3D;32, kernel_size&#x3D;(3, 3), padding&#x3D;&#39;same&#39;, activation&#x3D;&#39;relu&#39;, input_shape&#x3D;input_shape))\n    model.add(MaxPooling2D(pool_size&#x3D;2))\n\n    model.add(Conv2D(filters&#x3D;32, kernel_size&#x3D;2, padding&#x3D;&#39;same&#39;, activation&#x3D;&#39;relu&#39;))\n    model.add(MaxPooling2D(pool_size&#x3D;(2, 2)))\n\n    model.add(Conv2D(filters&#x3D;32, kernel_size&#x3D;2, padding&#x3D;&#39;same&#39;, activation&#x3D;&#39;relu&#39;))\n    model.add(MaxPooling2D(pool_size&#x3D;(2, 2)))\n\n    model.add(Dropout(0.3))\n    model.add(Flatten())\n    model.add(Dense(500, activation&#x3D;&#39;relu&#39;))\n\n    model.add(Dropout(0.4))\n\n    model.add(Dense(num_classes, activation&#x3D;&#39;softmax&#39;))\n\n    # æ¨¡å‹æ¦‚è¿°\n    print(model.summary())\n    return model</code></pre>\n\n<p>åœ¨æ¨¡å‹çš„å®šä¹‰ä¸­ï¼Œæˆ‘ä»¬ä»¥å†…æ ¸å¤§å°ä¸º3çš„<a href=\"https://keras.io/layers/convolutional/\">å·ç§¯</a>ï¼Œè¿™ä¹Ÿæ„å‘³ç€çª—å£ä¸º3x3åƒç´ ï¼Œè¾“å…¥å½¢çŠ¶çš„å¤§å°ä¸º28x28åƒç´ ã€‚ç´§è·Ÿç€ä½¿ç”¨äº†ä¸€ä¸ªæ± åŒ–å¤§å°ä¸º2çš„<a href=\"https://keras.io/layers/pooling/\">æ± åŒ–å±‚</a>ï¼Œè¿™é‡Œçš„æ± åŒ–å¤§å°ä¸º2ï¼Œæ„å‘³ç€å°†ä¼šå¯¹æ¯ä¸€ä¸ªè¾“å…¥ç¼©å‡ä¸ºåŸæ¥çš„ä¸€èˆ¬ï¼Œå› æ­¤åœ¨ä¸‹ä¸€ä¸ªå·ç§¯å±‚ä¸­ï¼Œè¾“å…¥å¤§å°ä¸º14x14åƒç´ ã€‚æŒ‰ç…§æ­¤æ–¹å¼é‡å¤ä¸¤æ¬¡åï¼Œæœ€ç»ˆçš„å·ç§¯è¾“å…¥å¤§å°è½¬æ¢ä¸º3x3åƒç´ ã€‚æ¥ä¸‹æ¥ï¼Œä½¿ç”¨äº†<a href=\"https://keras.io/layers/core/#dropout\">Dropoutå±‚</a>ï¼Œå°†30%çš„è¾“å…¥å•å…ƒéšæœºè®¾ç½®ä¸º0ï¼Œä»¥é˜²æ­¢è®­ç»ƒçš„è¿‡æ‹Ÿåˆã€‚æœ€åï¼Œå±•å¹³è¾“å…¥å±‚ï¼ˆæ­¤ä¾‹å­ä¸­ä¸º3x3x32&#x3D;288ï¼‰ï¼Œå¹¶å°†å®ƒä»¬è¿æ¥åˆ°ä¸€ä¸ªå…·æœ‰500ä¸ªè¾“å…¥çš„å¯†åº¦å±‚ã€‚åœ¨è¿™äº›æ­¥éª¤ä¹‹åï¼Œæ·»åŠ äº†å¦ä¸€ä¸ªDropoutå±‚ï¼Œä¹‹åè¿æ¥åˆ°æœ€åçš„å¯†åº¦å±‚ï¼Œè¯¥å¯†åº¦å±‚ä¸­åŒ…å«10ä¸ªè¾“å‡ºå•å…ƒï¼Œè¿™äº›è¾“å‡ºå•å…ƒå¯¹åº”ç€æˆ‘ä»¬çš„ç›®æ ‡ç±»åˆ«ï¼Œ0åˆ°9ä¹‹é—´çš„æ•°å­—ã€‚</p>\n<pre><code>_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d_1 (Conv2D)            (None, 28, 28, 32)        320       \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 14, 14, 32)        0         \n_________________________________________________________________\nconv2d_2 (Conv2D)            (None, 14, 14, 32)        4128      \n_________________________________________________________________\nmax_pooling2d_2 (MaxPooling2 (None, 7, 7, 32)          0         \n_________________________________________________________________\nconv2d_3 (Conv2D)            (None, 7, 7, 32)          4128      \n_________________________________________________________________\nmax_pooling2d_3 (MaxPooling2 (None, 3, 3, 32)          0         \n_________________________________________________________________\ndropout_1 (Dropout)          (None, 3, 3, 32)          0         \n_________________________________________________________________\nflatten_1 (Flatten)          (None, 288)               0         \n_________________________________________________________________\ndense_1 (Dense)              (None, 500)               144500    \n_________________________________________________________________\ndropout_2 (Dropout)          (None, 500)               0         \n_________________________________________________________________\ndense_2 (Dense)              (None, 10)                5010      \n=================================================================\nTotal params: 158,086\nTrainable params: 158,086\nNon-trainable params: 0\n_________________________________________________________________\n</code></pre>\n<h2 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"7-è®­ç»ƒæ¨¡å‹\"><a href=\"#7-è®­ç»ƒæ¨¡å‹\" class=\"headerlink\" title=\"7. è®­ç»ƒæ¨¡å‹\"></a>7. è®­ç»ƒæ¨¡å‹</h2><pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># è®­ç»ƒæ¨¡å‹\nmodel &#x3D; network()\n# ç¼–è¯‘æ¨¡å‹\nmodel.compile(loss&#x3D;&#39;categorical_crossentropy&#39;, optimizer&#x3D;Adadelta(), metrics&#x3D;[&#39;accuracy&#39;])\n# ä½¿ç”¨è®­ç»ƒæ•°æ®æ‹Ÿåˆæ¨¡å‹\nmodel.fit(X_train, Y_train, batch_size&#x3D;512, epochs&#x3D;6, verbose&#x3D;1, validation_data&#x3D;(X_test, Y_test))\n# æ¨¡å‹è¯„ä¼°åˆ†æ•°\nscore &#x3D; model.evaluate(X_test, Y_test, verbose&#x3D;0)\n\nprint(&#39;Test loss:&#39;, score[0])\nprint(&#39;Test accuracy:&#39;, score[1])</code></pre>\n\n<p>è¿™é‡Œä½¿ç”¨äº†<code>categorical_crossentropy</code>ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç›®æ ‡ç±»åˆ«æœ‰å¤šä¸ªï¼ˆ0è‡³9ï¼‰ï¼ŒKerasåº“æä¾›äº†å¤šç§<a href=\"https://keras.io/optimizers/#usage-of-optimizers\">ä¼˜åŒ–å™¨</a>ï¼Œä½ å¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªè¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå¹¶æœ€ç»ˆæ‰¾åˆ°ä¸€ä¸ªæœ€å¥½çš„ã€‚ç»è¿‡å°è¯•ä¹‹åï¼Œè¿™é‡Œé€‰æ‹©<a href=\"https://keras.io/optimizers/#adadelta\"><code>AdaDelta</code></a>ä½œä¸ºä¼˜åŒ–å™¨è¿›è¡Œæ¨¡å‹è®­ç»ƒï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥å°è¯•AdaDeltaçš„é«˜çº§ç‰ˆ<a href=\"https://keras.io/optimizers/#adagrad\">AdaGrad</a>ã€‚</p>\n<p><img src=\"https://liip.rokka.io/www_inarticle/42b4b8/train.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œç»è¿‡è®­ç»ƒï¼Œæ‰€å¾—åˆ°çš„æ¨¡å‹è¯†åˆ«å‡†ç¡®ç‡è¾¾åˆ°äº†98%ï¼Œè€ƒè™‘åˆ°è¿™é‡Œä»…ä»…ä½¿ç”¨äº†ç®€å•çš„ç½‘ç»œç»“æ„ï¼Œè¾¾åˆ°è¿™æ ·çš„å‡†ç¡®ç‡å·²ç»æ˜¯éå¸¸å‡ºè‰²äº†ã€‚åœ¨ä¸Šè¿°æˆªå›¾ä¸­ï¼Œæ¯æ¬¡è¿­ä»£çš„å‡†ç¡®æ€§éƒ½æ˜¯åœ¨æé«˜ï¼Œå¯ä»¥è¯´æ˜è¿™é‡Œä½¿ç”¨çš„ç®€å•ç»“æ„æ˜¯åˆç†çš„ï¼Œè®­ç»ƒå¾—åˆ°çš„æ¨¡å‹å¯ä»¥å¾ˆå¥½åœ°é¢„æµ‹è¾“å…¥28x28åƒç´ æ‰€è¡¨ç¤ºçš„æ•°å­—ã€‚</p>\n<h2 id=\"8-ä¿å­˜æ¨¡å‹\"><a href=\"#8-ä¿å­˜æ¨¡å‹\" class=\"headerlink\" title=\"8. ä¿å­˜æ¨¡å‹\"></a>8. ä¿å­˜æ¨¡å‹</h2><p>ç”±äºæˆ‘ä»¬æƒ³è¦åœ¨iOSè®¾å¤‡ä¸Šä½¿ç”¨è¯¥æ¨¡å‹ï¼Œå› æ­¤éœ€è¦å°†è¯¥æ¨¡å‹è½¬æ¢ä¸ºiOSç³»ç»Ÿèƒ½å¤Ÿç†è§£çš„æ ¼å¼ã€‚å®é™…ä¸Šï¼Œå¾®è½¯ã€Facebookä»¥åŠäºšé©¬é€Šç­‰ä¼ä¸šå·²ç»ç ”å‘å‡ºäº†ä¸€å¥—èƒ½å¤Ÿåœ¨æ‰€æœ‰æ·±åº¦å­¦ä¹ ç½‘ç»œæ ¼å¼è§è½¬æ¢çš„åè®®ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨ä»»ä½•è®¾å¤‡ä¸Šä½¿ç”¨çš„å¯äº¤æ¢çš„å¼€æ”¾å¼ç¥ç»ç½‘ç»œäº¤æ¢æ ¼å¼â€”â€”<a href=\"https://onnx.ai/\">ONNX</a>ã€‚</p>\n<p>ä½†æ˜¯ï¼Œæˆªæ­¢ç›®å‰ï¼ŒAppleè®¾å¤‡ä¸Šä»…ä»…èƒ½å¤Ÿä½¿ç”¨çš„æ˜¯CoreMLæ ¼å¼ã€‚ä¸ºäº†èƒ½å¤Ÿå°†Kerasæ¨¡å‹è½¬æ¢ä¸ºCoreMLæ ¼å¼ï¼ŒAppleç‰¹æ„æ¨å‡ºæ¥ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„å¸®åŠ©ç±»åº“â€”â€”<a href=\"https://apple.github.io/coremltools/generated/coremltools.converters.keras.convert.html\">coremltools</a>ï¼Œè¿™é‡Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¯¥ç±»åº“æ¥å®Œæˆå·¥ä½œã€‚è¯¥ç±»åº“èƒ½å¤Ÿå°†scikit-learnã€Kerasã€XGBoostç­‰æœºå™¨å­¦ä¹ ç±»åº“è®­ç»ƒçš„æ¨¡å‹è½¬æ¢ä¸ºCoreMLæ”¯æŒçš„æ ¼å¼ï¼Œä»è€Œä½¿å¾—æ¨¡å‹èƒ½å¤Ÿç›´æ¥åœ¨Appleè®¾å¤‡ä¸Šä½¿ç”¨ã€‚å¦‚æœä½ è¿˜æœªå®‰è£…coremltoolsç±»åº“ï¼Œå¯ä»¥ä½¿ç”¨<code>pip install coremltools</code>è¿›è¡Œå®‰è£…ï¼Œç„¶åå†ä½¿ç”¨ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">coreml_model &#x3D; coremltools.converters.keras.convert(model,\n                                                        input_names&#x3D;&quot;image&quot;,\n                                                        image_input_names&#x3D;&#39;image&#39;,\n                                                        class_labels&#x3D;[&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;]\n                                                        )</code></pre>\n\n<p>åœ¨è¿›è¡Œæ¨¡å‹è½¬æ¢çš„æ—¶å€™ï¼Œæœ€é‡è¦çš„å‚æ•°æ˜¯class_labelsï¼Œå®ƒå®šä¹‰äº†æ¨¡å‹å°è¯•é¢„æµ‹çš„ç±»æ•°ï¼Œä»¥åŠinput_namesæˆ–è€…image_input_namesã€‚é€šè¿‡å°†å®ƒä»¬è®¾ç½®ä¸ºå›¾åƒï¼ŒXcodeä¼šè‡ªåŠ¨è¯†åˆ«è¯¥æ¨¡å‹æ˜¯å…³äºæ¥æ”¶å›¾åƒå¹¶ä»ä¸­é¢„æµ‹æŸäº›å†…å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™äº›å‚æ•°æ˜¯å‘Šè¯‰Xcodeï¼Œè¯¥æ¨¡å‹æ˜¯å…³äºé‚£æ–¹é¢çš„ä»»åŠ¡ã€‚æ ¹æ®åº”ç”¨ç¨‹åºå’Œæ¨¡å‹çš„ç‰¹å®šåŠŸèƒ½ï¼Œéœ€è¦ç ”ç©¶<a href=\"https://apple.github.io/coremltools/generated/coremltools.converters.keras.convert.html\">å®˜æ–¹æ–‡æ¡£</a>è¿›ä¸€æ­¥çš„äº†è§£è¿™äº›å‚æ•°çš„å¯é€‰å€¼ç­‰ã€‚</p>\n<p>å¦å¤–è¿˜æœ‰ä¸€äº›å¯ä»¥å®šä¹‰æ¨¡å‹å…ƒä¿¡æ¯çš„å‚æ•°ï¼Œè¿™äº›å‚æ•°å¯ä»¥ç»™æ¨¡å‹ä¸€ä¸ªç®€è¦çš„è¯´æ˜ï¼Œç”šè‡³ä½œè€…ã€licenseç­‰ï¼Œå¯ä»¥è®©ä½¿ç”¨è€…èƒ½å¤Ÿæ–¹ä¾¿çš„æŸ¥é˜…æ¨¡å‹æ‰€é’ˆå¯¹çš„ç‰¹å®šä»»åŠ¡ç­‰ã€‚</p>\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># ç¼–è¾‘æ¨¡å‹å…ƒä¿¡æ¯\ncoreml_model.author &#x3D; &#39;Robin&#39;\ncoreml_model.license &#x3D; &#39;MIT&#39;\ncoreml_model.short_description &#x3D; &#39;MNIST handwriting recognition with a 3 layer network&#39;\ncoreml_model.input_description[&#39;image&#39;] &#x3D; &#39;28x28 grayscaled pixel values between 0-1&#39;\ncoreml_model.save(&#39;SimpleMnist.mlmodel&#39;)\n\nprint(coreml_model)</code></pre>\n\n<h2 id=\"9-ä½¿ç”¨æ¨¡å‹é¢„æµ‹\"><a href=\"#9-ä½¿ç”¨æ¨¡å‹é¢„æµ‹\" class=\"headerlink\" title=\"9. ä½¿ç”¨æ¨¡å‹é¢„æµ‹\"></a>9. ä½¿ç”¨æ¨¡å‹é¢„æµ‹</h2><p>åœ¨å°†æ¨¡å‹ä¿å­˜ä¸ºCoreMLæ ¼å¼ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨è½¬æ¢åçš„æ¨¡å‹è¿›è¡Œä¸€ä¸ªé¢„æµ‹ï¼Œæ¥ç¡®å®šæ¨¡å‹æ˜¯å¦å·¥ä½œæ­£å¸¸ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å°†ä»MNISTæ•°æ®é›†ä¸­é€‰æ‹©ä¸€å¼ å›¾åƒè¿›è¡Œé¢„æµ‹éªŒè¯ã€‚</p>\n <pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># ä½¿ç”¨CoreMLæ¨¡å‹é¢„æµ‹éªŒè¯\n from PIL import Image  \n import numpy as np\n model &#x3D;  coremltools.models.MLModel(&#39;SimpleMnist.mlmodel&#39;)\n im &#x3D; Image.fromarray((np.reshape(mnist_data()[0][0][12]*255, (28, 28))).astype(np.uint8),&quot;L&quot;)\n plt.imshow(im)\n predictions &#x3D; model.predict(&#123;&#39;image&#39;: im&#125;)\n print(predictions)</code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre><code>&#123;u&#39;classLabel&#39;: u&#39;3&#39;, \nu&#39;output1&#39;: &#123;u&#39;1&#39;: 0.0, \n                        u&#39;0&#39;: 0.0, \n                        u&#39;3&#39;: 1.0, \n                        u&#39;2&#39;: 0.0, \n                        u&#39;5&#39;: 0.0, \n                        u&#39;4&#39;: 0.0, \n                        u&#39;7&#39;: 0.0, \n                        u&#39;6&#39;: 0.0, \n                        u&#39;9&#39;: 0.0, \n                        u&#39;8&#39;: 0.0\n                        &#125;\n&#125;\n</code></pre>\n<p><img src=\"/images/keras-mnist-for-ios/download-45f07bef-9ca6-4ea6-a674-789607207e9c.png\"></p>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œé¢„æµ‹è¿‡ç¨‹å’Œç»“æœå‡ç¬¦åˆé¢„æœŸã€‚æ¥ä¸‹æ¥æ˜¯æ—¶å€™åœ¨Xcodeé¡¹ç›®ä¸­ä½¿ç”¨è¯¥æ¨¡å‹äº†ã€‚</p>\n<h1 id=\"10æ­¥å®Œæˆæ¨¡å‹åœ¨Xcodeé¡¹ç›®ä¸­çš„åº”ç”¨\"><a href=\"#10æ­¥å®Œæˆæ¨¡å‹åœ¨Xcodeé¡¹ç›®ä¸­çš„åº”ç”¨\" class=\"headerlink\" title=\"10æ­¥å®Œæˆæ¨¡å‹åœ¨Xcodeé¡¹ç›®ä¸­çš„åº”ç”¨\"></a>10æ­¥å®Œæˆæ¨¡å‹åœ¨Xcodeé¡¹ç›®ä¸­çš„åº”ç”¨</h1><p>ä¸ºäº†èƒ½å¤Ÿè®©å‡ ä¹æ‰€æœ‰äººäº†è§£æœºå™¨å­¦ä¹ æ¨¡å‹æ–‡ä»¶æ˜¯å¦‚ä½•ä¸€æ­¥ä¸€æ­¥åœ¨Xcodeé¡¹ç›®ä¸­ä½¿ç”¨çš„ï¼Œè¿™é‡Œå°†ä¼šä»æœ€ä¸ºåŸºç¡€çš„Xcodeå®‰è£…ã€é¡¹ç›®åˆ›å»ºç­‰è¯´èµ·ï¼Œå¦‚æœä½ æ˜¯iOSå¼€å‘çš„è€é¸Ÿï¼Œéƒ¨åˆ†å†…å®¹è¯·è‡ªè¡Œç•¥è¿‡ã€‚</p>\n<h2 id=\"1-å®‰è£…Xcode\"><a href=\"#1-å®‰è£…Xcode\" class=\"headerlink\" title=\"1. å®‰è£…Xcode\"></a>1. å®‰è£…Xcode</h2><p>å¯¹äºiOSä½“ç³»æ¥è¯´ï¼ŒXcodeæ˜¯å¼€å‘iOSåº”ç”¨ç¨‹åºå¿…é¡»çš„å·¥å…·ä¹‹ä¸€ï¼Œå› æ­¤å¦‚æœä½ è¿˜æœªå®‰è£…Xcodeï¼Œéœ€è¦å®‰è£…Xcodeï¼Œæœ€ä¸ºç®€å•çš„æ–¹å¼æ˜¯åœ¨Mac App Storeä¸­æœç´¢å¹¶å®‰è£…ã€‚å¦‚æœä½ å·²ç»å®‰è£…äº†Xcodeï¼Œéœ€è¦ç¡®ä¿Xcodeçš„ç‰ˆæœ¬è‡³å°‘åœ¨9.0æˆ–ä»¥ä¸Šã€‚</p>\n<h2 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"2-åˆ›å»ºé¡¹ç›®\"><a href=\"#2-åˆ›å»ºé¡¹ç›®\" class=\"headerlink\" title=\"2. åˆ›å»ºé¡¹ç›®\"></a>2. åˆ›å»ºé¡¹ç›®</h2><p>å®‰è£…å¥½Xcodeä¹‹åï¼Œå¼€å¯Xcodeï¼Œé€‰æ‹©iOSå¹³å°ä¸‹çš„å•è§†å›¾åº”ç”¨ï¼Œå‘½åé¡¹ç›®ï¼Œè¿™é‡Œå‘½åä¸ºâ€œMNIST-Demoâ€ï¼Œé€‰æ‹©ä¸€ä¸ªä¿å­˜é¡¹ç›®æ–‡ä»¶çš„ä½ç½®ï¼Œåˆ›å»ºé¡¹ç›®å³å¯ã€‚</p>\n<p><img src=\"/images/keras-mnist-for-ios/Untitled-78fa75ca-4376-49e8-b194-bde1699f9be3.png\"></p>\n<h2 id=\"3-æ·»åŠ CoreMLæ¨¡å‹æ–‡ä»¶\"><a href=\"#3-æ·»åŠ CoreMLæ¨¡å‹æ–‡ä»¶\" class=\"headerlink\" title=\"3. æ·»åŠ CoreMLæ¨¡å‹æ–‡ä»¶\"></a>3. æ·»åŠ CoreMLæ¨¡å‹æ–‡ä»¶</h2><p>ç°åœ¨ï¼Œä½ å¯ä»¥å°†é€šè¿‡coremltoolsè½¬æ¢å¾—åˆ°çš„CoreMLæ¨¡å‹åŠ å…¥åˆ°é¡¹ç›®ä¸­äº†ã€‚æœ€ç®€å•çš„æ–¹å¼æ˜¯ç›´æ¥æ‹–æ‹½æ¨¡å‹æ–‡ä»¶åˆ°é¡¹ç›®ç›®å½•ä¸­ï¼Œå¦‚æœä¸ºäº†ä¹‹åæ›´æ–°æ¨¡å‹è€Œä¸ç”¨å»åˆ æ‰é‡æ–°æ·»åŠ ï¼Œä½ å¯ä»¥åœ¨å¼¹å‡ºçš„é€‰é¡¹æ¡†ä¸­é€‰æ‹©â€œadd as Referenceâ€ã€‚</p>\n<p><img src=\"/images/keras-mnist-for-ios/add-model-98101cf6-8cf8-4d2a-b58e-30d397c98354.png\"></p>\n<h2 id=\"4-åˆ é™¤ä¸éœ€è¦çš„è§†å›¾æˆ–è€…æ•…äº‹ç‰ˆ\"><a href=\"#4-åˆ é™¤ä¸éœ€è¦çš„è§†å›¾æˆ–è€…æ•…äº‹ç‰ˆ\" class=\"headerlink\" title=\"4. åˆ é™¤ä¸éœ€è¦çš„è§†å›¾æˆ–è€…æ•…äº‹ç‰ˆ\"></a>4. åˆ é™¤ä¸éœ€è¦çš„è§†å›¾æˆ–è€…æ•…äº‹ç‰ˆ</h2><p>å› ä¸ºæˆ‘ä»¬ä»…ä»…ä½¿ç”¨ç›¸æœºå¹¶æ˜¾ç¤ºæ ‡ç­¾ï¼Œå› æ­¤è¿™é‡Œä¼šåˆ é™¤æ‰é¡¹ç›®ä¸­é»˜è®¤çš„ä¸€äº›ç”¨æˆ·ç•Œé¢ï¼Œä¹Ÿå°±æ˜¯é¡¹ç›®ä¸­çš„è§†å›¾æ§åˆ¶å™¨å’Œæ•…äº‹é¢æ¿ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸åˆ é™¤ï¼Œç›´æ¥ä½¿ç”¨ç°æœ‰çš„è§†å›¾å’Œæ•…äº‹é¢æ¿è¿›è¡Œå¼€å‘ï¼Œä¸è®ºé€‰æ‹©å“ªç§æ–¹å¼éƒ½èƒ½è¾¾åˆ°ç›®çš„ã€‚è¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœé€‰æ‹©ç¼–ç çš„æ–¹å¼æ„å»ºåº”ç”¨ï¼Œå†åˆ é™¤äº†ä¸»æ•…äº‹é¢æ¿æ–‡ä»¶åï¼Œéœ€è¦åœ¨é¡¹ç›®çš„TARGETSä¸­åŒæ­¥åˆ é™¤â€Main Interfaceâ€çš„é»˜è®¤è®¾ç½®ã€‚</p>\n<p><img src=\"/images/keras-mnist-for-ios/ScreenShot2018-11-22at10-9150b677-f351-4732-bfb6-d74019527380.32.46AM.png\"></p>\n<h2 id=\"5-ç¨‹åºåŒ–åˆ›å»ºæ ¹è§†å›¾æ§åˆ¶å™¨\"><a href=\"#5-ç¨‹åºåŒ–åˆ›å»ºæ ¹è§†å›¾æ§åˆ¶å™¨\" class=\"headerlink\" title=\"5. ç¨‹åºåŒ–åˆ›å»ºæ ¹è§†å›¾æ§åˆ¶å™¨\"></a>5. ç¨‹åºåŒ–åˆ›å»ºæ ¹è§†å›¾æ§åˆ¶å™¨</h2><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä½¿ç”¨ä»£ç çš„æ–¹å¼ï¼Œé‡æ–°åˆ¶å®šåº”ç”¨ç¨‹åºçš„æ ¹è§†å›¾ã€‚å…·ä½“å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-swift\" data-language=\"swift\"><code class=\"language-swift\">&#x2F;&#x2F; é€šè¿‡ç¼–ç çš„æ–¹å¼æŒ‡å®šæ ¹è§†å›¾æ§åˆ¶å™¨\nfunc application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: Any]?) -&gt; Bool &#123;\n     &#x2F;&#x2F; åˆ›å»ºçª—å£\n     window &#x3D; UIWindow()\n     window?.makeKeyAndVisible()\n        \n     &#x2F;&#x2F; æŒ‡å®šæ ¹è§†å›¾æ§åˆ¶å™¨\n     let vc &#x3D; ViewController()\n     window?.rootViewController &#x3D; vc\n        \n     return true\n&#125;</code></pre>\n\n<h2 id=\"6-æ„å»ºè§†å›¾æ§åˆ¶å™¨ç»†èŠ‚\"><a href=\"#6-æ„å»ºè§†å›¾æ§åˆ¶å™¨ç»†èŠ‚\" class=\"headerlink\" title=\"6. æ„å»ºè§†å›¾æ§åˆ¶å™¨ç»†èŠ‚\"></a>6. æ„å»ºè§†å›¾æ§åˆ¶å™¨ç»†èŠ‚</h2><p>æ¥ä¸‹æ¥å°±æ˜¯æ„å»ºè§†å›¾æ§åˆ¶å™¨çš„è¯¦ç»†å†…å®¹ç»†èŠ‚äº†ã€‚æˆ‘ä»¬éœ€è¦ä»¥ä¸‹å¯äº¤äº’çš„å…ƒç´ ç»„ä»¶ï¼Œä¾‹å¦‚æŒ‰é’®ï¼Œä¹Ÿéœ€è¦ä½œä¸ºå±•ç¤ºç»“æœæˆ–è€…çŠ¶æ€çš„æ ‡ç­¾ç­‰ï¼Œå¦å¤–é‡è¦çš„æ˜¯ï¼Œç”±äºéœ€è¦ä½¿ç”¨ç›¸æœºï¼Œå› æ­¤AVFoundationç±»åº“æ˜¯å¿…é¡»è¦æ·»åŠ çš„ï¼Œè¯¥åº“ç”¨æ¥è®¿é—®å’Œæ§åˆ¶iOSè®¾å¤‡ä¸Šçš„ç›¸æœºï¼Œè¿˜éœ€è¦Visionåº“ï¼Œè¯¥åº“æ˜¯iOSæ¨å‡ºçš„ç”¨äºè®¡ç®—æœºè§†è§‰ç›¸å…³ä»»åŠ¡çš„å·¥å…·åº“ï¼Œèƒ½å¤Ÿå¾ˆå¥½çš„å’ŒCoreMLæ¨¡å‹ä¹‹é—´è¿›è¡Œäº¤äº’ç­‰ã€‚</p>\n<p>å…·ä½“çš„ä»£ç ç»†èŠ‚ï¼Œè¿™é‡Œä¸å†ç´¯è¿°ï¼Œå®Œæˆä¹‹åçš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-swift\" data-language=\"swift\"><code class=\"language-swift\">&#x2F;&#x2F; å®šä¹‰è§†å›¾æ§åˆ¶å™¨\nimport UIKit\nimport AVFoundation\nimport Vision\n\n&#x2F;&#x2F; ç”±äºè¦ä½¿ç”¨åˆ°ç›¸æœºè®¾å¤‡è¿›è¡Œè§†é¢‘æµçš„è¾“å…¥ï¼Œå› æ­¤è¿™é‡Œè¦ç»§æ‰¿AVCaptureVideoDataOutputSampleBufferDelegateåè®®\nclass ViewController: UIViewController, AVCaptureVideoDataOutputSampleBufferDelegate &#123;\n    &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–‡æœ¬æ ‡ç­¾ç”¨æ¥æ˜¾ç¤ºè¯†åˆ«ç»“æœ\n    let label: UILabel &#x3D; &#123;\n        let label &#x3D; UILabel()\n        label.textColor &#x3D; .white\n        label.translatesAutoresizingMaskIntoConstraints &#x3D; false\n        label.text &#x3D; &quot;Label&quot;\n        label.font &#x3D; label.font.withSize(40)\n        return label\n    &#125;()\n\n    override func viewDidLoad() &#123;\n        &#x2F;&#x2F; è°ƒç”¨ç›¸æœºè®¾å¤‡è®¾ç½®æ–¹æ³•ã€æ–‡æœ¬æ ‡ç­¾è®¾ç½®æ–¹æ³•\n        super.viewDidLoad()       \n        setupCaptureSession()\n        view.addSubview(label)\n        setupLabel()\n    &#125;\n\n        &#x2F;&#x2F; è®¾ç½®ç›¸æœºè®¾å¤‡session\n    func setupCaptureSession() &#123;\n        &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ–°çš„æ•è·session\n        let captureSession &#x3D; AVCaptureSession()\n\n        &#x2F;&#x2F; æŸ¥æ‰¾å¯ç”¨çš„ç›¸æœºè®¾å¤‡\n        let availableDevices &#x3D; AVCaptureDevice.DiscoverySession(deviceTypes: [.builtInWideAngleCamera], mediaType: AVMediaType.video, position: .back).devices\n\n        do &#123;\n            &#x2F;&#x2F; é€‰æ‹©é¦–ä¸ªè®¾å¤‡å¹¶è®¾ç½®ä¸ºè¾“å…¥æº\n            if let captureDevice &#x3D; availableDevices.first &#123;\n                captureSession.addInput(try AVCaptureDeviceInput(device: captureDevice))\n            &#125;\n        &#125; catch &#123;\n            &#x2F;&#x2F; å¦‚æœæœªæ‰¾åˆ°ç›¸æœºè®¾å¤‡ï¼Œåˆ™æ‰“å°é”™è¯¯ä¿¡æ¯\n            print(error.localizedDescription)\n        &#125;\n\n        &#x2F;&#x2F; å°†è§†é¢‘è¾“å‡ºè®¾ç½®åˆ°å±å¹•å¹¶å°†è¾“å‡ºæ·»åŠ åˆ°æˆ‘ä»¬çš„æ•è·ä¼šè¯\n        let captureOutput &#x3D; AVCaptureVideoDataOutput()\n        captureSession.addOutput(captureOutput)\n        let previewLayer &#x3D; AVCaptureVideoPreviewLayer(session: captureSession)\n        previewLayer.frame &#x3D; view.frame\n        view.layer.addSublayer(previewLayer)\n\n        &#x2F;&#x2F; ç¼“å†²è§†é¢‘å¹¶å¯åŠ¨æ•è·ä¼šè¯\n        captureOutput.setSampleBufferDelegate(self, queue: DispatchQueue(label: &quot;videoQueue&quot;))\n        captureSession.startRunning()\n    &#125;\n\n    func captureOutput(_ output: AVCaptureOutput, didOutput sampleBuffer: CMSampleBuffer, from connection: AVCaptureConnection) &#123;\n        &#x2F;&#x2F; åŠ è½½Core ML æ¨¡å‹\n        guard let model &#x3D; try? VNCoreMLModel(for: SimpleMnist().model) else &#123; return &#125;\n\n        &#x2F;&#x2F; ä½¿ç”¨Core MLè¿è¡Œæ¨ç†\n        let request &#x3D; VNCoreMLRequest(model: model) &#123; (finishedRequest, error) in\n\n            &#x2F;&#x2F; æ•è·æ¨ç†ç»“æœ\n            guard let results &#x3D; finishedRequest.results as? [VNClassificationObservation] else &#123; return &#125;\n\n            &#x2F;&#x2F; æ•è·å¾—åˆ†æœ€é«˜çš„æ¨ç†ç»“æœ\n            guard let Observation &#x3D; results.first else &#123; return &#125;\n\n            &#x2F;&#x2F; æ„å»ºæœ€ç»ˆæ˜¾ç¤ºçš„æ–‡æœ¬æ ¼å¼\n            let predclass &#x3D; &quot;\\(Observation.identifier)&quot;\n\n            &#x2F;&#x2F; æ˜¾ç¤ºåœ¨æ–‡æœ¬æ ‡ç­¾å†…\n            DispatchQueue.main.async(execute: &#123;\n                self.label.text &#x3D; &quot;\\(predclass) &quot;\n            &#125;)\n        &#125;\n\n          &#x2F;&#x2F; åˆ›å»ºä¸€ä¸ªæ ¸å¿ƒè§†é¢‘åƒç´ ç¼“å†²åŒºï¼Œå®ƒæ˜¯ä¸€ä¸ªå›¾åƒç¼“å†²åŒºï¼Œç”¨äºä¿å­˜ä¸»å­˜å‚¨å™¨ä¸­çš„åƒç´ ç”Ÿæˆå¸§ï¼Œ\n                &#x2F;&#x2F; å‹ç¼©æˆ–è§£å‹ç¼©è§†é¢‘æˆ–ä½¿ç”¨æ ¸å¿ƒå›¾åƒçš„åº”ç”¨ç¨‹åºéƒ½å¯ä»¥ä½¿ç”¨æ ¸å¿ƒè§†é¢‘åƒç´ ç¼“å†²åŒº\n        guard let pixelBuffer: CVPixelBuffer &#x3D; CMSampleBufferGetImageBuffer(sampleBuffer) else &#123; return &#125;\n\n        &#x2F;&#x2F; æ‰§è¡Œè¯·æ±‚\n        try? VNImageRequestHandler(cvPixelBuffer: pixelBuffer, options: [:]).perform([request])\n    &#125;\n\n    func setupLabel() &#123;\n        label.centerXAnchor.constraint(equalTo: view.centerXAnchor).isActive &#x3D; true\n        label.bottomAnchor.constraint(equalTo: view.bottomAnchor, constant: -50).isActive &#x3D; true\n    &#125;\n&#125;</code></pre>\n\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>å¦‚æœä½ ç›´æ¥ä½¿ç”¨ä¸Šè¿°ä»£ç ï¼Œè¯·è®°å¾—ä¿®æ”¹æ¨¡å‹çš„åç§°ã€‚</p></blockquote>\n<p><img src=\"/images/keras-mnist-for-ios/Untitled-503351b4-b11a-4e7b-a7ad-de4017cbac28.png\"></p>\n<h2 id=\"6-æ·»åŠ éšç§è¯´æ˜ä¿¡æ¯\"><a href=\"#6-æ·»åŠ éšç§è¯´æ˜ä¿¡æ¯\" class=\"headerlink\" title=\"6. æ·»åŠ éšç§è¯´æ˜ä¿¡æ¯\"></a>6. æ·»åŠ éšç§è¯´æ˜ä¿¡æ¯</h2><p>ç”±äºæˆ‘ä»¬è¦ä½¿ç”¨ç›¸æœºè®¾å¤‡è¿›è¡Œè§†é¢‘æ•°æ®æµçš„è·å–ï¼Œå› æ­¤éœ€è¦åœ¨Xcodeå·¥ç¨‹é¡¹ç›®ä¸­çš„info.plistæ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”çš„æƒé™ç”³è¯·è¯´æ˜â€œ<em>Privacy - Camera Usage Description</em>â€ï¼Œå¹¶é™„å¸¦ç›¸åº”çš„è¯´æ˜æ€§æ–‡å­—ï¼š</p>\n<p><img src=\"/images/keras-mnist-for-ios/Untitled-8e6fa826-e368-47d0-8256-588a136119db.png\"></p>\n<h2 id=\"7-åŠ å…¥è‹¹æœå¼€å‘è€…è®¡åˆ’\"><a href=\"#7-åŠ å…¥è‹¹æœå¼€å‘è€…è®¡åˆ’\" class=\"headerlink\" title=\"7. åŠ å…¥è‹¹æœå¼€å‘è€…è®¡åˆ’\"></a>7. åŠ å…¥è‹¹æœå¼€å‘è€…è®¡åˆ’</h2><p>ä¸ºäº†èƒ½å¤Ÿè®©è¯¥åº”ç”¨ç¨‹åºè¿è¡Œåœ¨ä½ çš„æ‰‹æœºè®¾å¤‡ä¸Šï¼Œä½ å¯èƒ½éœ€è¦æ³¨å†Œ<a href=\"https://developer.apple.com/programs/enroll/\">è‹¹æœçš„å¼€å‘è€…è®¡åˆ’</a>ã€‚å½“ç„¶å¦‚æœä½ ä¸æƒ³ä¸ºäº†è¿è¡Œé¡¹ç›®è€ŒèŠ±è´¹é‡‘é’±ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‰ç…§<a href=\"https://9to5mac.com/2016/03/27/how-to-create-free-apple-developer-account-sideload-apps/\">æ­¤æ•™ç¨‹</a>æ³¨å†Œå…è´¹çš„è´¦æˆ·ã€‚</p>\n<h2 id=\"8-åœ¨iPhoneè®¾å¤‡ä¸Šå‘å¸ƒåº”ç”¨\"><a href=\"#8-åœ¨iPhoneè®¾å¤‡ä¸Šå‘å¸ƒåº”ç”¨\" class=\"headerlink\" title=\"8. åœ¨iPhoneè®¾å¤‡ä¸Šå‘å¸ƒåº”ç”¨\"></a>8. åœ¨iPhoneè®¾å¤‡ä¸Šå‘å¸ƒåº”ç”¨</h2><p>ä¸€åˆ‡å‡†å¤‡å¥½ä¹‹åï¼Œä½ å°±å¯ä»¥å°†è¯¥åº”ç”¨ç¨‹åºå‘å¸ƒåˆ°ä½ çš„æ‰‹æœºè®¾å¤‡ä¸Šäº†ã€‚ä½ å¯ä»¥æŒ‰ç…§å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ–¹å¼å‘å¸ƒé¡¹ç›®ï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨Xcodeä¸­é€‰å®šç›®æ ‡è®¾å¤‡ï¼Œç„¶åä½¿ç”¨å¿«æ·é”®CMD+Rçš„æ–¹å¼æ„å»ºï¼š</p>\n<p><img src=\"/images/keras-mnist-for-ios/Untitled-1a74e4bf-8c84-4e49-95f2-4b46f8f4102f.png\"></p>\n<h2 id=\"9-ä½¿ç”¨åº”ç”¨ç¨‹åº\"><a href=\"#9-ä½¿ç”¨åº”ç”¨ç¨‹åº\" class=\"headerlink\" title=\"9. ä½¿ç”¨åº”ç”¨ç¨‹åº\"></a>9. ä½¿ç”¨åº”ç”¨ç¨‹åº</h2><p>ç»è¿‡ä¸Šè¿°å„ç§è®¾ç½®å’Œç¼–ç ä¹‹åï¼Œç»ˆäºå¯ä»¥åœ¨è®¾å¤‡ä¸Šè¿è¡Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºäº†ã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œé¦–æ¬¡åº”ç”¨ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œä¼šè¯¢é—®ä½ æ˜¯å¦å…è®¸åº”ç”¨ç¨‹åºè®¿é—®è®¾å¤‡çš„ç›¸æœºï¼Œè¿™é‡Œéœ€è¦å…è®¸ï¼Œå¦åˆ™æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºåˆ™æ— æ³•æ­£å¸¸å·¥ä½œã€‚</p>\n<p>å¦å¤–ï¼Œæˆ‘ä»¬è¿™é‡Œæ‰€è®­ç»ƒçš„æ¨¡å‹ä»¥åŠåˆ¶ä½œçš„åº”ç”¨ç¨‹åºï¼Œæ²¡æœ‰è¿›è¡Œè¯¦ç»†çš„è®¾è®¡å’Œä¼˜åŒ–ï¼Œåœ¨è¯†åˆ«çš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°è¯†åˆ«ä¸å‡ºæ¥ä»¥åŠè¯†åˆ«é”™è¯¯çš„æƒ…å†µï¼Œå¦‚æœéœ€è¦å°†æ­¤åŠŸèƒ½åº”ç”¨åœ¨ä½ çš„äº§å“ä¸­ï¼Œéœ€è¦ä¸¥æ ¼é‡æ–°å®¡æŸ¥ä½ æ‰€æ‹¥æœ‰çš„æ•°æ®ï¼Œä»¥åŠæ¨¡å‹çš„è®­ç»ƒï¼Œappçš„ä½¿ç”¨ç­‰ï¼Œä»¥å…å‡ºç°ä¸å¯é¢„çŸ¥çš„é”™è¯¯ç­‰é—®é¢˜ã€‚</p>\n<p><img src=\"https://liip.rokka.io/www_inarticle/812493/output.gif\"></p>\n<h1 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h1><p>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œå¸Œæœ›èƒ½å¤Ÿè®©ä½ äº†è§£å¦‚ä½•ä½¿ç”¨Kerasè®­ç»ƒæ‰€éœ€è¦çš„æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•å°†å…¶åº”ç”¨åœ¨iOSå¹³å°ä¸‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œè™½ç„¶ä»‹ç»çš„ä¸å¤Ÿæ·±å…¥ï¼Œä½†æ˜¯å¸Œæœ›èƒ½å¤Ÿå¸¦ç»™ä½ ç»§ç»­æ·±å…¥ç†è§£Kerasã€äº†è§£Core MLçš„æ¬²æœ›ï¼Œæ—©æ—¥åœ¨ä½ çš„åº”ç”¨ç¨‹åºä¸­å®ç°AIçš„èƒ½åŠ›ï¼Œä¸ºä½ çš„åº”ç”¨ç¨‹åºå¢æ·»è‰²å½©ã€‚</p>\n","text":"æœ¬æ–‡å°†ä»‹ç»å¦‚ä½•æ„å»ºå’Œè®­ç»ƒä¸€ä¸ªæ·±åº¦å­¦ä¹ ç½‘ç»œæ¥è¯†åˆ«æ‰‹å†™æ•°å­—ï¼Œä»¥åŠå¦‚ä½•å°†è®­ç»ƒæ‰€å¾—çš„æ·±åº¦ç½‘ç»œæ¨¡å‹è½¬æ¢ä¸ºiOSå¹³å°çš„æœºå™¨å­¦ä¹ æ¡†æ¶CoreMLæ ¼å¼ï¼Œå¹¶é›†æˆè¿›iOSåº”ç”¨ç¨‹åºä¸­ä»¥å®æ—¶è¯†åˆ«æ•°å­—ç­‰ã€‚ 10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨TLDRï¼› æœ¬æ–‡ä¸­æš‚æ—¶ä¸ä¼šä»‹ç»å·ç§¯ç¥ç»ç½‘ç»œçš„ç»†èŠ‚å†…å®¹ï¼Œä¾‹å¦‚å¦‚...","link":"","photos":[],"count_time":{"symbolsCount":"17k","symbolsTime":"15 mins."},"categories":[{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","count":10,"path":"api/categories/æœºå™¨å­¦ä¹ .json"}],"tags":[{"name":"æœºå™¨å­¦ä¹  Keras MNIST","slug":"æœºå™¨å­¦ä¹ -Keras-MNIST","count":1,"path":"api/tags/æœºå™¨å­¦ä¹ -Keras-MNIST.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#10%E6%AD%A5%E4%B9%8B%E5%86%85%E5%AE%8C%E6%88%90%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%9E%84%E5%BB%BA%E3%80%81%E8%AE%AD%E7%BB%83%E5%92%8C%E5%8F%91%E5%B8%83%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">10æ­¥ä¹‹å†…å®Œæˆæ¨¡å‹çš„æ„å»ºã€è®­ç»ƒå’Œå‘å¸ƒä½¿ç”¨</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%A6%82%E4%BD%95%E5%BC%80%E5%A7%8B\"><span class=\"toc-text\">1. å¦‚ä½•å¼€å§‹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">2. è·å–æ•°æ®</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E6%AD%A3%E7%A1%AE%E5%9C%B0%E7%BC%96%E7%A0%81\"><span class=\"toc-text\">3. æ­£ç¡®åœ°ç¼–ç </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\"><span class=\"toc-text\"></span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E8%A7%84%E8%8C%83%E5%8C%96%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">4. è§„èŒƒåŒ–æ•°æ®</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-One-Hot-%E7%BC%96%E7%A0%81\"><span class=\"toc-text\">5. One-Hot ç¼–ç </span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#-1\"><span class=\"toc-text\"></span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%9E%8B%E5%8C%96\"><span class=\"toc-text\">6. ç½‘ç»œæ¨¡å‹åŒ–</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#-2\"><span class=\"toc-text\"></span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#7-%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B\"><span class=\"toc-text\">7. è®­ç»ƒæ¨¡å‹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#8-%E4%BF%9D%E5%AD%98%E6%A8%A1%E5%9E%8B\"><span class=\"toc-text\">8. ä¿å­˜æ¨¡å‹</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#9-%E4%BD%BF%E7%94%A8%E6%A8%A1%E5%9E%8B%E9%A2%84%E6%B5%8B\"><span class=\"toc-text\">9. ä½¿ç”¨æ¨¡å‹é¢„æµ‹</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#10%E6%AD%A5%E5%AE%8C%E6%88%90%E6%A8%A1%E5%9E%8B%E5%9C%A8Xcode%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">10æ­¥å®Œæˆæ¨¡å‹åœ¨Xcodeé¡¹ç›®ä¸­çš„åº”ç”¨</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#1-%E5%AE%89%E8%A3%85Xcode\"><span class=\"toc-text\">1. å®‰è£…Xcode</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#-3\"><span class=\"toc-text\"></span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#2-%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE\"><span class=\"toc-text\">2. åˆ›å»ºé¡¹ç›®</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#3-%E6%B7%BB%E5%8A%A0CoreML%E6%A8%A1%E5%9E%8B%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">3. æ·»åŠ CoreMLæ¨¡å‹æ–‡ä»¶</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#4-%E5%88%A0%E9%99%A4%E4%B8%8D%E9%9C%80%E8%A6%81%E7%9A%84%E8%A7%86%E5%9B%BE%E6%88%96%E8%80%85%E6%95%85%E4%BA%8B%E7%89%88\"><span class=\"toc-text\">4. åˆ é™¤ä¸éœ€è¦çš„è§†å›¾æˆ–è€…æ•…äº‹ç‰ˆ</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#5-%E7%A8%8B%E5%BA%8F%E5%8C%96%E5%88%9B%E5%BB%BA%E6%A0%B9%E8%A7%86%E5%9B%BE%E6%8E%A7%E5%88%B6%E5%99%A8\"><span class=\"toc-text\">5. ç¨‹åºåŒ–åˆ›å»ºæ ¹è§†å›¾æ§åˆ¶å™¨</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E6%9E%84%E5%BB%BA%E8%A7%86%E5%9B%BE%E6%8E%A7%E5%88%B6%E5%99%A8%E7%BB%86%E8%8A%82\"><span class=\"toc-text\">6. æ„å»ºè§†å›¾æ§åˆ¶å™¨ç»†èŠ‚</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#6-%E6%B7%BB%E5%8A%A0%E9%9A%90%E7%A7%81%E8%AF%B4%E6%98%8E%E4%BF%A1%E6%81%AF\"><span class=\"toc-text\">6. æ·»åŠ éšç§è¯´æ˜ä¿¡æ¯</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#7-%E5%8A%A0%E5%85%A5%E8%8B%B9%E6%9E%9C%E5%BC%80%E5%8F%91%E8%80%85%E8%AE%A1%E5%88%92\"><span class=\"toc-text\">7. åŠ å…¥è‹¹æœå¼€å‘è€…è®¡åˆ’</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#8-%E5%9C%A8iPhone%E8%AE%BE%E5%A4%87%E4%B8%8A%E5%8F%91%E5%B8%83%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">8. åœ¨iPhoneè®¾å¤‡ä¸Šå‘å¸ƒåº”ç”¨</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#9-%E4%BD%BF%E7%94%A8%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F\"><span class=\"toc-text\">9. ä½¿ç”¨åº”ç”¨ç¨‹åº</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%80%BB%E7%BB%93\"><span class=\"toc-text\">æ€»ç»“</span></a></li></ol>","author":{"slug":"undefined","avatar":"/img/avatar.jpg","link":"https://github.com/zycslog","description":"","socials":{}},"mapped":true,"prev_post":{"title":"iOSè™šæ‹Ÿå†…å­˜ç®¡ç†","uid":"11480c51ae26bed2fd1029069074ca32","slug":"2019-01-22-iOS_VMManage","date":"2023-05-13T14:55:49.791Z","updated":"2023-05-13T14:55:49.791Z","comments":true,"path":"api/articles/2019-01-22-iOS_VMManage.json","keywords":null,"cover":"/images/vm/memory_manage.jpg","text":"è™šæ‹Ÿå†…å­˜æ˜¯ä¸€ç§å…è®¸æ“ä½œç³»ç»Ÿé¿å¼€ç‰©ç†RAMé™åˆ¶çš„å†…å­˜ç®¡ç†æœºåˆ¶ã€‚è™šæ‹Ÿå†…å­˜ç®¡ç†å™¨ä¸ºæ¯ä¸ªè¿›ç¨‹åˆ›å»ºä¸€ä¸ªé€»è¾‘åœ°å€ç©ºé—´æˆ–è€…è™šæ‹Ÿå†…å­˜åœ°å€ç©ºé—´ï¼Œå¹¶ä¸”å°†å®ƒåˆ†é…ä¸ºç›¸åŒå¤§å°çš„å†…å­˜å—ï¼Œå¯ç§°ä¸ºé¡µã€‚å¤„ç†å™¨ä¸å†…å­˜ç®¡ç†å•å…ƒMMUç»´æŒä¸€ä¸ªé¡µè¡¨æ¥æ˜ å°„ç¨‹åºé€»è¾‘åœ°å€ç©ºé—´åˆ°è®¡ç®—æœºRAMçš„ç¡¬ä»¶åœ°å€ã€‚å½“ç¨‹åºçš„ä»£ç è®¿é—®å†…å­˜ä¸­çš„ä¸€...","link":"","photos":[],"count_time":{"symbolsCount":"21k","symbolsTime":"19 mins."},"categories":[{"name":"å¼€å‘çŸ¥è¯†","slug":"å¼€å‘çŸ¥è¯†","count":9,"path":"api/categories/å¼€å‘çŸ¥è¯†.json"}],"tags":[{"name":"å¼€å‘çŸ¥è¯† iOS","slug":"å¼€å‘çŸ¥è¯†-iOS","count":7,"path":"api/tags/å¼€å‘çŸ¥è¯†-iOS.json"}],"author":{"slug":"undefined","avatar":"/img/avatar.jpg","link":"https://github.com/zycslog","description":"","socials":{}}},"next_post":{"title":"2022-07-17  é‡æ„é‚£äº›äº‹","uid":"9f08952be24e03501c17b0dc2ee6bf37","slug":"2022-07-17-log-refactor","date":"2022-07-17T20:30:38.000Z","updated":"2023-05-13T14:55:49.799Z","comments":true,"path":"api/articles/2022-07-17-log-refactor.json","keywords":null,"cover":null,"text":"WHATï¼šä»€ä¹ˆæ˜¯é‡æ„ï¼Ÿ Martin Fowlerï¼šé‡æ„æ˜¯ä¸€ç§å¯¹è½¯ä»¶å†…éƒ¨ç»“æ„çš„æ”¹å–„ï¼Œç›®çš„æ˜¯åœ¨ä¸æ”¹å˜è½¯ä»¶çš„å¯è§è¡Œä¸ºçš„æƒ…å†µä¸‹ï¼Œä½¿å…¶æ›´æ˜“ç†è§£ï¼Œä¿®æ”¹æˆæœ¬æ›´ä½ã€‚ å¤§å‹é‡æ„ å¯¹è±¡ï¼šå¯¹ç³»ç»Ÿã€æ¨¡å—ã€ä»£ç ç»“æ„ã€ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»ç­‰çš„é‡æ„ æ–¹æ³•ï¼šæœ‰åˆ†å±‚å‚ç›´æ‹†åˆ†ã€æ¨¡å—åŒ–æ°´å¹³æ‹†åˆ†ã€è§£è€¦ã€æŠ½è±¡UIç»„ä»¶ã€æŠ½è±¡...","link":"","photos":[],"count_time":{"symbolsCount":"1.7k","symbolsTime":"2 mins."},"categories":[{"name":"Logs","slug":"Logs","count":3,"path":"api/categories/Logs.json"}],"tags":[],"author":{"name":"Yak-0xff","slug":"blog-author","avatar":"/img/avatar.jpg","link":"/","description":"ä¸€ä½ä¸æ»¡ç°çŠ¶ï¼Œå°±çˆ±çæŠ˜è…¾çš„æŠ€æœ¯äºº <br /> ğŸ¤” <b>å‹¿ä»¥äº‹å°è€Œä¸ä¸º</b>","socials":{"github":"https://github.com/zycslog","twitter":"https://twitter.com/zh_robin","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"https://juejin.cn/user/3104676569682525","customs":{}}}}}