---
layout: post
author: Robin
title: \#2\ 认识 Array & Dictionary
tags: Swift中的数据结构与算法
categories:
- Data Structures & Algorithms in Swift
cover: '/images/Data-Structures-&-Algorithms-in-Swift/2/cover.jpg'
---

在 **Swift Standard Library** 中包含了Swift语言的核心组件。在标准库框架中你可以发现很多可用于应用程序开发的同居和类型，在开始设计自己的数据结构前，了解Swift语言本身的语言特性是设计良好数据结构和算法设计的基础。

在此篇内容中，着重了解 Swift Standard Library 中的两大数据结构：**Array & Dictionary**。

## Array

**Array** 是一个通用型的容器组件，用于存储元素的有序集合，在Swift语言中被大量使用。**Swift Standard Library**中的 **Array** 可以使用任意的数据类型创建数组。例如使用文字创建数据时，文字使用用逗号分隔，方括号括起来，如下：

```swift
var people = ["Brian", "Stanley", "Ringo"]
```

在Swift中，Array的定义是通过协议定义的，不同的协议层给Array提供了不同的能力。例如，数组是一个**序列(Sequence)**，至少可以遍历它一次。它也是一个**集合(Collection)**，又可以被多次遍历，而且不具有破坏性，并且可以使用下标运算符访问它。数组也是一个**随机访问集合(RandomAccessCollection)**，它保证了效率。

上文提到，Swift中的Array是一个通用型的数据结构，意味着你可以在数据中使用任何数据类型。事实上，在Swift标准库中有大量的通用型代码。

对于任何数据结构，都会有一些显著性的特征值的关注，对于Array来说，首先需要关注的是 --- **顺序**。

##### 顺序（Order）

Array中的元素（Element）具有显性的顺序，例如上述`people`数组，"Brian" 会出现在 "Stanley" 的前面。

数据中的所有元素都有一个明确的基于0开始的整数类型下标。例如上述例子中，数组中包含了三个元素，每一个下标将对应唯一的一个元素，可以通过下标的方式获取具体的某个元素。例如：

```swift
people[0] // "Brian"
people[1] // "Stanley"
people[2] // "Ringo"
```

数据中的元素顺序是显著性的，该顺序也是数组的数据结构所定义的，但是需要注意的是并不是所有的集合类型都有显著性的顺序。例如**Dictionary**，并没有显著性的顺序，仅有有一个弱化的顺序的概念。

##### 随机访问权限（Random-access）

**随机访问权限**是数组的数据结构所定义的特性，表示在数组可以在恒定的时间内完成数据元素的检索。例如在上述数组中，"Brian"元素的获取总是在恒定的时间内。同样地，并不是所有的集合类型都是如此，例如链表、树并没有随机访问权限，元素的获取也不会有恒定的时间。

### 数组的性能

随机访问权限的另一个影响是数组操作的**性能**。对于一个开发者而言，对于数组的各种操作，了解其在数据量持续增大的情况下性能的变更，是影响程序是否高效的关键因素之一。而对于数组而言，影响其性能的因素主要有两个：

##### 插入位置（Insertion location）

在Swift中，数组的插入操作大多数高效的规则是进行数据元素的追加，也就是在现有数据上使用追加的方式，在数据末尾添加新的元素：

```swift
people.append("Charles")
print(people)  // ["Brian", "Stanley", "Ringo", "Charles"]
```

上述示例中使用`append`方法，在数组的末尾位置插入了新的元素"Charles"，这个操作的耗时是恒定的，也意味着不论原数组中的元素有多少，在该数组的末尾插入新的元素并不会带来额外的时间消耗。但是如果在原数组的除了末尾位置之外的其他既定位置插入元素，例如在数组的中间位置插入新的元素，会带来更多的时间消耗。

举个例子，人们正在按秩序排队进行结账，此时来了一个新的顾客，在不妨碍其他任何人的情况下，新顾客应该直接在队伍的尾部加入队伍，也不会引起其他人的反感等，而如果该新顾客非要走到队伍中间位置插队，那么该位置后面的每一个人都需要向后挪动，这样至少给原有队伍中一半的人带来的愤怒。

有一条经验是，**如果在开发工作中，你需要在原有的集合类型数据结构中，频繁的在集合的头部或者非末尾位置进行元素的插入，那你可能需要重新设计你的数据结构了。**

##### 数组容量（Capacity）

影响数组性能的另一个因素便是**数组的容量**，这里所说的容量是数组的预制容量。Swift中的数组是根据数组中的元素总量来进行内存空间的预开辟的。如果数组的容量已经达到了预设定的最大值，那么数组必须重构自己来为新的元素增加空间。这一步操作是底层帮你完成的，系统会拷贝所有原有的元素并在内存中新建一个更大容量的数组，这将带来性能和时间的消耗，因为数组中的每一个元素都需要被访问到并进行拷贝。

也就意味着，数组的插入操作，除了在数组的末尾进行追加式插入新元素外，其他的插入操作都会使得数组进行 *n*（数组大小） 步才能完整操作。

## Dictionary

**Dictionary** 是另一种集合类型的数据结构，存储**key-value对**数据。例如：

```swift
var scores: [String: Int] = ["Eric": 9, "Mark": 12, "Wayne": 1]
```

在字典中没有任何既定的顺序，也不能通过索引插入。在Swift中，字典的必备条件是key值必须是`Hashable`的。幸运的是，在最近几个版本的Swift中，几乎所有的标准类型都遵循`Hashable`协议，开发者不用自己去实现`Hashable`了。

在字典中插入新的数据，一般情况下，通过如下的句法进行：

```swift
scores["Andrew"] = 0
```

这样底层实现会创建一个新的`key-value`对，并添加到字典中：

```swift
["Eric": 9, "Andrew": 0, "Mark": 12, "Wayne": 1]
```

可以看到字典是无序的集合类型。对于同一个字典，新数据的插入，会访问到字典中的每一个键值对，其消耗的时间是相同的，直到集合被改变。对于字典而言，并不需要关心数据插入和获取的时间消耗问题，每次操作都是字典中数据量的总访问时间。但是相对于数组来说，字典的数据获取会更高效。

## 关键点总结

* 每一种数据结构都有其优点和缺点，了解数据结构的优缺点，能够为高效的软件性能提供帮助；
* 数组是有序的集合。数组的插入操作会影响数组的操作耗时，末尾追加除外。如果在软件开发中，需要在数组的非末尾位置频繁的进行插入，可能需要重新设计数据结构，例如链表等；
* 字典是无序的集合。字典为了快速插入和搜索而牺牲了保持元素顺序的能力。